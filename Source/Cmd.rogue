# Generated and updated by Froley. Custom changes will not be overwritten; customize as desired.
module Boss

class Cmd( t:Token )
  GLOBAL METHODS
    method to_character( st:String )->Character
      if (st is null or st.count == 0) return Character(0)
      return st[0]

  METHODS
    method init( existing:Cmd )
      t = existing.t

    method cloned->ThisType [propagated]
      return ThisType(this)

    method add( cmd:Cmd )
      throw UnsupportedOperationError()

    method clear
      throw UnsupportedOperationError()

    method count->Int
      return 0

    method description->String
      return "Cmd"

    method dispatch<<$m,$VisitorType>>( visitor:$VisitorType )  [propagated]
      visitor.$m( this )

    method dispatch<<$m,$VisitorType,$ReturnType>>( visitor:$VisitorType )->$ReturnType [propagated]
      return visitor.$m( this )

    method first->Cmd
      throw UnsupportedOperationError()

    method get( index:Int )->Cmd
      throw UnsupportedOperationError()

    method get<<$AsType>>( index:Int )->$AsType
      return get(index)->(as $AsType)

    method insert( element:Cmd, before_index=0:Int )
      throw UnsupportedOperationError()

    method last->Cmd
      throw UnsupportedOperationError()

    method remove_first->Cmd
      throw UnsupportedOperationError()

    method remove_last->Cmd
      throw UnsupportedOperationError()

    method set( index:Int, value:Cmd )
      throw UnsupportedOperationError()

    method to->Character
      return Character(this->Int)

    method to->Cmd[]
      throw UnsupportedOperationError()

    method to->Int
      return 0

    method to->Logical
      return (this->Int)?

    method to->Real
      return this->Int

    method to->String
      return description

    method to->Token[]
      throw UnsupportedOperationError()
endClass

class CmdList : Cmd
  PROPERTIES
    list = Cmd[]

  METHODS
    method init( t )
      noAction

    method init( t, element:Cmd )
      list.add( element )

    method init( t, element1:Cmd, element2:Cmd )
      list.add( element1 )
      list.add( element2 )

    method init( existing:CmdList )
      prior.init( existing )

      # Start with shallow clone
      list = existing.list.cloned

      # Turn into deep clone
      localize list
      forEach (cmd at i in list)
        if (cmd) list[i] = cmd.cloned
      endForEach

    method add( cmd:Cmd )
      @list.add( cmd )

    method clear
      @list.clear

    method count->Int
      return @list.count

    method description->String
      return "CmdList" + list_description

    method first->Cmd
      return @list.first

    method get( index:Int )->Cmd
      return @list[index]

    method insert( element:Cmd, before_index=0:Int )
      list.insert( element, before_index )

    method last->Cmd
      return @list.last

    method list_description->String
      local builder = String()
      builder.print '['
      forEach (element at index in @list)
        if (index > 0) builder.print ','
        builder.print( %element )
      endForEach
      builder.print ']'
      return builder

    method remove_first->Cmd
      return @list.remove_first

    method remove_last->Cmd
      return @list.remove_last

    method set( index:Int, value:Cmd )
      @list[index] = value

    method to->Cmd[]
      return @list

endClass

class TokenList : Cmd
  PROPERTIES
    tokens : Token[]

  METHODS
    method init( t )
      tokens = Token[]

    method init( t, tokens )

    method init( existing:TokenList )
      tokens = existing.tokens.cloned

    method description->String
      return "TokenList($)"(tokens)

    method to->Token[]
      return tokens
endClass

class Unary( t, operand:Cmd ) : Cmd
  METHODS
    method init( existing:Unary )
      prior.init( existing )
      operand = existing.operand.cloned

    method description->String
      return "Unary($)"(%operand)
endClass

class Binary( t, left:Cmd, right:Cmd ) : Cmd
  METHODS
    method init( existing:Binary )
      prior.init( existing )
      left = existing.left.cloned
      right = existing.right.cloned

    method description->String
      return "Binary($,$)"(%left,%right)
endClass

class Add : Binary
  METHODS
    method description->String
      return "Add($,$)" (%left,%right)

endClass

class Args : CmdList
  METHODS
    method description->String
      return "Args" + list_description
endClass

class Divide : Binary
  METHODS
    method description->String
      return "Divide($,$)" (%left,%right)

endClass

class LiteralString : Cmd
  PROPERTIES
    value : String

  METHODS
    method init( t, value )

    method init( existing:LiteralString )
      prior.init( existing )
      value = existing.value

    method description->String
      return "LiteralString($)" (%value)

    method to->Character
      return Cmd.to_character(value)

    method to->Int:     return value
    method to->Logical: return value?
    method to->String: return value

endClass

class Multiply : Binary
  METHODS
    method description->String
      return "Multiply($,$)" (%left,%right)

endClass

class Negate : Unary
  METHODS
    method description->String
      return "Negate($)" (%operand)

endClass

class Statements : CmdList
  METHODS
    method description->String
      return "Statements" + list_description
endClass

class Subtract : Binary
  METHODS
    method description->String
      return "Subtract($,$)" (%left,%right)

endClass

class Literal : Cmd
  METHODS
    method description->String
      return "Literal"
endClass

class LiteralPrimitive : Literal
  METHODS
    method description->String
      return "LiteralPrimitive"
endClass

class AddAndAssignGlobalProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "AddAndAssignGlobalProperty($,$)" (%info,%operand)

endClass

class AddAndAssignLocal : ResolvedOpAndAssignLocal
  METHODS
    method description->String
      return "AddAndAssignLocal($,$)" (%info,%operand)

endClass

class AddAndAssignProperty : ResolvedOpAndAssignProperty
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, info, operand )

    method init( existing:AddAndAssignProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "AddAndAssignProperty($,$,$)" (%context,%info,%operand)

endClass

class AddAndAssignThisProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "AddAndAssignThisProperty($,$)" (%info,%operand)

endClass

class AnonymousTuple : CmdList
  METHODS
    method description->String
      return "AnonymousTuple" + list_description
endClass

class AnonymousTupleTypeElements : CmdList
  METHODS
    method description->String
      return "AnonymousTupleTypeElements" + list_description
endClass

class As : Cmd
  PROPERTIES
    operand : Cmd
    as_type : Type

  METHODS
    method init( t, operand, as_type )

    method init( existing:As )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned
      if (existing.as_type) as_type = existing.as_type.cloned

    method description->String
      return "As($,$)" (%operand,%as_type)

endClass

class AttributeAPI : Cmd
  METHODS
    method description->String
      return "AttributeAPI"
endClass

class AttributeAbstract : Cmd
  METHODS
    method description->String
      return "AttributeAbstract"
endClass

class AttributeAppend : Cmd
  METHODS
    method description->String
      return "AttributeAppend"
endClass

class AttributeAspect : Cmd
  METHODS
    method description->String
      return "AttributeAspect"
endClass

class AttributeBitflags : Cmd
  METHODS
    method description->String
      return "AttributeBitflags"
endClass

class AttributeCompound : Cmd
  METHODS
    method description->String
      return "AttributeCompound"
endClass

class AttributeEssential : Cmd
  METHODS
    method description->String
      return "AttributeEssential"
endClass

class AttributeExport : Cmd
  METHODS
    method description->String
      return "AttributeExport"
endClass

class AttributeFallback : Cmd
  METHODS
    method description->String
      return "AttributeFallback"
endClass

class AttributeFaux : Cmd
  METHODS
    method description->String
      return "AttributeFaux"
endClass

class AttributeInsert : Cmd
  METHODS
    method description->String
      return "AttributeInsert"
endClass

class AttributeMutating : Cmd
  METHODS
    method description->String
      return "AttributeMutating"
endClass

class AttributeOverride : Cmd
  METHODS
    method description->String
      return "AttributeOverride"
endClass

class AttributePreferred : Cmd
  METHODS
    method description->String
      return "AttributePreferred"
endClass

class AttributePrimitive : Cmd
  METHODS
    method description->String
      return "AttributePrimitive"
endClass

class AttributePropagated : Cmd
  METHODS
    method description->String
      return "AttributePropagated"
endClass

class AttributeReplace : Cmd
  METHODS
    method description->String
      return "AttributeReplace"
endClass

class AttributeReturnsThis : Cmd
  METHODS
    method description->String
      return "AttributeReturnsThis"
endClass

class AttributeSingleton : Cmd
  METHODS
    method description->String
      return "AttributeSingleton"
endClass

class Attributes : CmdList
  METHODS
    method description->String
      return "Attributes" + list_description
endClass

class BitShiftLeft : Binary
  METHODS
    method description->String
      return "BitShiftLeft($,$)" (%left,%right)

endClass

class BitShiftLeftAndAssignGlobalProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "BitShiftLeftAndAssignGlobalProperty($,$)" (%info,%operand)

endClass

class BitShiftLeftAndAssignLocal : ResolvedOpAndAssignLocal
  METHODS
    method description->String
      return "BitShiftLeftAndAssignLocal($,$)" (%info,%operand)

endClass

class BitShiftLeftAndAssignProperty : ResolvedOpAndAssignProperty
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, info, operand )

    method init( existing:BitShiftLeftAndAssignProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "BitShiftLeftAndAssignProperty($,$,$)" (%context,%info,%operand)

endClass

class BitShiftLeftAndAssignThisProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "BitShiftLeftAndAssignThisProperty($,$)" (%info,%operand)

endClass

class BitShiftRight : Binary
  METHODS
    method description->String
      return "BitShiftRight($,$)" (%left,%right)

endClass

class BitShiftRightX : Binary
  METHODS
    method description->String
      return "BitShiftRightX($,$)" (%left,%right)

endClass

class BitShiftRightXAndAssignGlobalProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "BitShiftRightXAndAssignGlobalProperty($,$)" (%info,%operand)

endClass

class BitShiftRightXAndAssignLocal : ResolvedOpAndAssignLocal
  METHODS
    method description->String
      return "BitShiftRightXAndAssignLocal($,$)" (%info,%operand)

endClass

class BitShiftRightXAndAssignProperty : ResolvedOpAndAssignProperty
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, info, operand )

    method init( existing:BitShiftRightXAndAssignProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "BitShiftRightXAndAssignProperty($,$,$)" (%context,%info,%operand)

endClass

class BitShiftRightXAndAssignThisProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "BitShiftRightXAndAssignThisProperty($,$)" (%info,%operand)

endClass

class BitwiseAnd : Binary
  METHODS
    method description->String
      return "BitwiseAnd($,$)" (%left,%right)

endClass

class BitwiseAndAndAssignGlobalProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "BitwiseAndAndAssignGlobalProperty($,$)" (%info,%operand)

endClass

class BitwiseAndAndAssignLocal : ResolvedOpAndAssignLocal
  METHODS
    method description->String
      return "BitwiseAndAndAssignLocal($,$)" (%info,%operand)

endClass

class BitwiseAndAndAssignProperty : ResolvedOpAndAssignProperty
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, info, operand )

    method init( existing:BitwiseAndAndAssignProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "BitwiseAndAndAssignProperty($,$,$)" (%context,%info,%operand)

endClass

class BitwiseAndAndAssignThisProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "BitwiseAndAndAssignThisProperty($,$)" (%info,%operand)

endClass

class BitwiseNot : Unary
  METHODS
    method description->String
      return "BitwiseNot($)" (%operand)

endClass

class BitwiseOr : Binary
  METHODS
    method description->String
      return "BitwiseOr($,$)" (%left,%right)

endClass

class BitwiseOrAndAssignGlobalProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "BitwiseOrAndAssignGlobalProperty($,$)" (%info,%operand)

endClass

class BitwiseOrAndAssignLocal : ResolvedOpAndAssignLocal
  METHODS
    method description->String
      return "BitwiseOrAndAssignLocal($,$)" (%info,%operand)

endClass

class BitwiseOrAndAssignProperty : ResolvedOpAndAssignProperty
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, info, operand )

    method init( existing:BitwiseOrAndAssignProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "BitwiseOrAndAssignProperty($,$,$)" (%context,%info,%operand)

endClass

class BitwiseOrAndAssignThisProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "BitwiseOrAndAssignThisProperty($,$)" (%info,%operand)

endClass

class BitwiseXor : Binary
  METHODS
    method description->String
      return "BitwiseXor($,$)" (%left,%right)

endClass

class BitwiseXorAndAssignGlobalProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "BitwiseXorAndAssignGlobalProperty($,$)" (%info,%operand)

endClass

class BitwiseXorAndAssignLocal : ResolvedOpAndAssignLocal
  METHODS
    method description->String
      return "BitwiseXorAndAssignLocal($,$)" (%info,%operand)

endClass

class BitwiseXorAndAssignProperty : ResolvedOpAndAssignProperty
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, info, operand )

    method init( existing:BitwiseXorAndAssignProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "BitwiseXorAndAssignProperty($,$,$)" (%context,%info,%operand)

endClass

class BitwiseXorAndAssignThisProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "BitwiseXorAndAssignThisProperty($,$)" (%info,%operand)

endClass

class Block : ControlStructure
  PROPERTIES
    assignments : Cmd

  METHODS
    method init( t, assignments, statements )

    method init( existing:Block )
      prior.init( existing )
      if (existing.assignments) assignments = existing.assignments.cloned

    method description->String
      return "Block($,$)" (%assignments,%statements)

endClass

class BriefTrace : Cmd
  PROPERTIES
    expressions : TracedExpressions

  METHODS
    method init( t, expressions )

    method init( existing:BriefTrace )
      prior.init( existing )
      if (existing.expressions) expressions = existing.expressions.cloned

    method description->String
      return "BriefTrace($)" (%expressions)

endClass

class CallbackFunction : Cmd
  PROPERTIES
    context     : Cmd
    name        : String
    param_types : TypeList

  METHODS
    method init( t, context, name, param_types )

    method init( existing:CallbackFunction )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      name = existing.name
      if (existing.param_types) param_types = existing.param_types.cloned

    method description->String
      return "CallbackFunction($,$,$)" (%context,%name,%param_types)

endClass

class Catch : ControlStructure
  PROPERTIES
    var_name       : String
    exception_type : Type

  METHODS
    method init( t, var_name, exception_type, statements )

    method init( existing:Catch )
      prior.init( existing )
      var_name = existing.var_name
      if (existing.exception_type) exception_type = existing.exception_type.cloned

    method description->String
      return "Catch($,$,$)" (%var_name,%exception_type,%statements)

endClass

class Catches : CmdList
  METHODS
    method description->String
      return "Catches" + list_description
endClass

class CleanupBlock : ControlStructure
  PROPERTIES
    cleanup : Cmd

  METHODS
    method init( t, statements, cleanup )

    method init( existing:CleanupBlock )
      prior.init( existing )
      if (existing.cleanup) cleanup = existing.cleanup.cloned

    method description->String
      return "CleanupBlock($,$)" (%statements,%cleanup)

endClass

class CommandExists : Cmd
  PROPERTIES
    command : Cmd

  METHODS
    method init( t, command )

    method init( existing:CommandExists )
      prior.init( existing )
      if (existing.command) command = existing.command.cloned

    method description->String
      return "CommandExists($)" (%command)

endClass

class Compare : Binary
  METHODS
    method description->String
      return "Compare($,$)" (%left,%right)

endClass

class CompareEQ : Binary
  METHODS
    method description->String
      return "CompareEQ($,$)" (%left,%right)

endClass

class CompareGE : Binary
  METHODS
    method description->String
      return "CompareGE($,$)" (%left,%right)

endClass

class CompareGT : Binary
  METHODS
    method description->String
      return "CompareGT($,$)" (%left,%right)

endClass

class CompareLE : Binary
  METHODS
    method description->String
      return "CompareLE($,$)" (%left,%right)

endClass

class CompareLT : Binary
  METHODS
    method description->String
      return "CompareLT($,$)" (%left,%right)

endClass

class CompareNE : Binary
  METHODS
    method description->String
      return "CompareNE($,$)" (%left,%right)

endClass

class CompareOp : Binary
  METHODS
    method description->String
      return "CompareOp($,$)" (%left,%right)

endClass

class Conditional : ControlStructure
  PROPERTIES
    condition : Cmd

  METHODS
    method init( t, condition, statements )

    method init( existing:Conditional )
      prior.init( existing )
      if (existing.condition) condition = existing.condition.cloned

    method description->String
      return "Conditional($,$)" (%condition,%statements)

endClass

class ContextBlock : Cmd
  PROPERTIES
    context  : Cmd
    commands : Cmd

  METHODS
    method init( t, context, commands )

    method init( existing:ContextBlock )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      if (existing.commands) commands = existing.commands.cloned

    method description->String
      return "ContextBlock($,$)" (%context,%commands)

endClass

class ContextBlockContext : Cmd
  METHODS
    method description->String
      return "ContextBlockContext"
endClass

class ContextDirectAccess : Cmd
  PROPERTIES
    context : Cmd
    name    : String

  METHODS
    method init( t, context, name )

    method init( existing:ContextDirectAccess )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      name = existing.name

    method description->String
      return "ContextDirectAccess($,$)" (%context,%name)

endClass

class Contingent : ControlStructure
  PROPERTIES
    satisfied_statements   : Cmd
    unsatisfied_statements : Cmd

  METHODS
    method init( t, statements, satisfied_statements, unsatisfied_statements )

    method init( existing:Contingent )
      prior.init( existing )
      if (existing.satisfied_statements) satisfied_statements = existing.satisfied_statements.cloned
      if (existing.unsatisfied_statements) unsatisfied_statements = existing.unsatisfied_statements.cloned

    method description->String
      return "Contingent($,$,$)" (%statements,%satisfied_statements,%unsatisfied_statements)

endClass

class Convert : Cmd
  PROPERTIES
    operand : Cmd

  METHODS
    method init( t, operand )

    method init( existing:Convert )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "Convert($)" (%operand)

endClass

class ConvertToByte : Convert
  METHODS
    method description->String
      return "ConvertToByte($)" (%operand)

endClass

class ConvertToCharacter : Convert
  METHODS
    method description->String
      return "ConvertToCharacter($)" (%operand)

endClass

class ConvertToInt : Convert
  METHODS
    method description->String
      return "ConvertToInt($)" (%operand)

endClass

class ConvertToInt32 : Convert
  METHODS
    method description->String
      return "ConvertToInt32($)" (%operand)

endClass

class ConvertToInt64 : Convert
  METHODS
    method description->String
      return "ConvertToInt64($)" (%operand)

endClass

class ConvertToLogical : Convert
  METHODS
    method description->String
      return "ConvertToLogical($)" (%operand)

endClass

class ConvertToReal : Convert
  METHODS
    method description->String
      return "ConvertToReal($)" (%operand)

endClass

class ConvertToReal32 : Convert
  METHODS
    method description->String
      return "ConvertToReal32($)" (%operand)

endClass

class ConvertToReal64 : Convert
  METHODS
    method description->String
      return "ConvertToReal64($)" (%operand)

endClass

class ConvertToType : Cmd
  PROPERTIES
    operand : Cmd
    to_type : Type

  METHODS
    method init( t, operand, to_type )

    method init( existing:ConvertToType )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned
      if (existing.to_type) to_type = existing.to_type.cloned

    method description->String
      return "ConvertToType($,$)" (%operand,%to_type)

endClass

class CreateRange : Cmd
  PROPERTIES
    start     : Cmd
    limit     : Cmd
    step_size : Cmd

  METHODS
    method init( t, start, limit, step_size )

    method init( existing:CreateRange )
      prior.init( existing )
      if (existing.start) start = existing.start.cloned
      if (existing.limit) limit = existing.limit.cloned
      if (existing.step_size) step_size = existing.step_size.cloned

    method description->String
      return "CreateRange($,$,$)" (%start,%limit,%step_size)

endClass

class CreateRangeDownTo : CreateRange
  METHODS
    method description->String
      return "CreateRangeDownTo($,$,$)" (%start,%limit,%step_size)

endClass

class CreateRangeDownToGreaterThan : CreateRange
  METHODS
    method description->String
      return "CreateRangeDownToGreaterThan($,$,$)" (%start,%limit,%step_size)

endClass

class CreateRangeUpTo : CreateRange
  METHODS
    method description->String
      return "CreateRangeUpTo($,$,$)" (%start,%limit,%step_size)

endClass

class CreateRangeUpToLessThan : CreateRange
  METHODS
    method description->String
      return "CreateRangeUpToLessThan($,$,$)" (%start,%limit,%step_size)

endClass

class DecrementGlobalProperty : Cmd
  PROPERTIES
    info : Property

  METHODS
    method init( t, info )

    method init( existing:DecrementGlobalProperty )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "DecrementGlobalProperty($)" (%info)

endClass

class DecrementLocal : Cmd
  PROPERTIES
    info : Local

  METHODS
    method init( t, info )

    method init( existing:DecrementLocal )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "DecrementLocal($)" (%info)

endClass

class DecrementProperty : Cmd
  PROPERTIES
    context : Cmd
    info    : Property

  METHODS
    method init( t, context, info )

    method init( existing:DecrementProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      if (existing.info) info = existing.info.cloned

    method description->String
      return "DecrementProperty($,$)" (%context,%info)

endClass

class DecrementThisProperty : Cmd
  PROPERTIES
    info : Property

  METHODS
    method init( t, info )

    method init( existing:DecrementThisProperty )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "DecrementThisProperty($)" (%info)

endClass

class DefaultArg : Unary
  METHODS
    method description->String
      return "DefaultArg($)" (%operand)

endClass

class DefaultValue : Cmd
  PROPERTIES
    of_type : Type

  METHODS
    method init( t, of_type )

    method init( existing:DefaultValue )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned

    method description->String
      return "DefaultValue($)" (%of_type)

endClass

class Definition : Cmd
  PROPERTIES
    name  : String
    value : Cmd

  METHODS
    method init( t, name, value )

    method init( existing:Definition )
      prior.init( existing )
      name = existing.name
      if (existing.value) value = existing.value.cloned

    method description->String
      return "Definition($,$)" (%name,%value)

endClass

class Describe : Unary
  METHODS
    method description->String
      return "Describe($)" (%operand)

endClass

class DirectAccess : Cmd
  PROPERTIES
    name : String

  METHODS
    method init( t, name )

    method init( existing:DirectAccess )
      prior.init( existing )
      name = existing.name

    method description->String
      return "DirectAccess($)" (%name)

    method to->Character
      return Cmd.to_character(name)

    method to->Int:     return name
    method to->Logical: return name?
    method to->String: return name

endClass

class DivideAndAssignGlobalProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "DivideAndAssignGlobalProperty($,$)" (%info,%operand)

endClass

class DivideAndAssignLocal : ResolvedOpAndAssignLocal
  METHODS
    method description->String
      return "DivideAndAssignLocal($,$)" (%info,%operand)

endClass

class DivideAndAssignProperty : ResolvedOpAndAssignProperty
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, info, operand )

    method init( existing:DivideAndAssignProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "DivideAndAssignProperty($,$,$)" (%context,%info,%operand)

endClass

class DivideAndAssignThisProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "DivideAndAssignThisProperty($,$)" (%info,%operand)

endClass

class DummyInitialValue : Cmd
  METHODS
    method description->String
      return "DummyInitialValue"
endClass

class EmptyCompound : Cmd
  PROPERTIES
    of_type : Type

  METHODS
    method init( t, of_type )

    method init( existing:EmptyCompound )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned

    method description->String
      return "EmptyCompound($)" (%of_type)

endClass

class EmptyVariantList : Cmd
  METHODS
    method description->String
      return "EmptyVariantList"
endClass

class EmptyVariantTable : Cmd
  METHODS
    method description->String
      return "EmptyVariantTable"
endClass

class EnumValue : Cmd
  PROPERTIES
    of_type : Type
    name    : String

  METHODS
    method init( t, of_type, name )

    method init( existing:EnumValue )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned
      name = existing.name

    method description->String
      return "EnumValue($,$)" (%of_type,%name)

endClass

class EnumValueDef : Cmd
  PROPERTIES
    value : Cmd

  METHODS
    method init( t, value )

    method init( existing:EnumValueDef )
      prior.init( existing )
      if (existing.value) value = existing.value.cloned

    method description->String
      return "EnumValueDef($)" (%value)

endClass

class Escape : Cmd
  METHODS
    method description->String
      return "Escape"
endClass

class ExplicitCast : Cmd
  PROPERTIES
    operand : Cmd
    to_type : Type

  METHODS
    method init( t, operand, to_type )

    method init( existing:ExplicitCast )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned
      if (existing.to_type) to_type = existing.to_type.cloned

    method description->String
      return "ExplicitCast($,$)" (%operand,%to_type)

endClass

class FunctionDefinition : Cmd
  PROPERTIES
    parameters  : Parameters
    return_type : Type
    with_values : WithValues
    statements  : Cmd

  METHODS
    method init( t, parameters, return_type, with_values, statements )

    method init( existing:FunctionDefinition )
      prior.init( existing )
      if (existing.parameters) parameters = existing.parameters.cloned
      if (existing.return_type) return_type = existing.return_type.cloned
      if (existing.with_values) with_values = existing.with_values.cloned
      if (existing.statements) statements = existing.statements.cloned

    method description->String
      return "FunctionDefinition($,$,$,$)" (%parameters,%return_type,%with_values,%statements)

endClass

class FunctionReturnValue : Cmd
  PROPERTIES
    operand : Cmd

  METHODS
    method init( t, operand )

    method init( existing:FunctionReturnValue )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "FunctionReturnValue($)" (%operand)

endClass

class FunctionType : Type
  PROPERTIES
    param_types : TypeList
    return_type : Type

  METHODS
    method init( t, param_types, return_type )

    method init( existing:FunctionType )
      prior.init( existing )
      if (existing.param_types) param_types = existing.param_types.cloned
      if (existing.return_type) return_type = existing.return_type.cloned

    method description->String
      return "FunctionType($,$)" (%param_types,%return_type)

endClass

class GenericFnArg : Cmd
  METHODS
    method description->String
      return "GenericFnArg"
endClass

class GenericFunctionDefinition : Cmd
  PROPERTIES
    parameters  : IDList
    with_values : WithValues
    statements  : Cmd

  METHODS
    method init( t, parameters, with_values, statements )

    method init( existing:GenericFunctionDefinition )
      prior.init( existing )
      if (existing.parameters) parameters = existing.parameters.cloned
      if (existing.with_values) with_values = existing.with_values.cloned
      if (existing.statements) statements = existing.statements.cloned

    method description->String
      return "GenericFunctionDefinition($,$,$)" (%parameters,%with_values,%statements)

endClass

class GetGlobalProperty : Cmd
  PROPERTIES
    info : Property

  METHODS
    method init( t, info )

    method init( existing:GetGlobalProperty )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "GetGlobalProperty($)" (%info)

endClass

class GetLocal : Cmd
  PROPERTIES
    info : Local

  METHODS
    method init( t, info )

    method init( existing:GetLocal )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "GetLocal($)" (%info)

endClass

class GetProperty : Cmd
  PROPERTIES
    context : Cmd
    info    : Property

  METHODS
    method init( t, context, info )

    method init( existing:GetProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      if (existing.info) info = existing.info.cloned

    method description->String
      return "GetProperty($,$)" (%context,%info)

endClass

class GetSingleton : Cmd
  PROPERTIES
    type : Type

  METHODS
    method init( t, type )

    method init( existing:GetSingleton )
      prior.init( existing )
      if (existing.type) type = existing.type.cloned

    method description->String
      return "GetSingleton($)" (%type)

endClass

class GetThisProperty : Cmd
  PROPERTIES
    info : Property

  METHODS
    method init( t, info )

    method init( existing:GetThisProperty )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "GetThisProperty($)" (%info)

endClass

class GetTypeInfo : Cmd
  PROPERTIES
    of_type : Type

  METHODS
    method init( t, of_type )

    method init( existing:GetTypeInfo )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned

    method description->String
      return "GetTypeInfo($)" (%of_type)

endClass

class GlobalMethod : Procedure
  METHODS
    method description->String
      return "GlobalMethod($,$,$,$,$,$)" (%name,%parameters,%return_type,%attributes,%doc,%statements)

endClass

class GlobalPropertyDeclarations : Cmd
  PROPERTIES
    list : Cmd
    type         : Type
    attributes   : Attributes
    doc          : String

  METHODS
    method init( t, list, type, attributes, doc )

    method init( existing:GlobalPropertyDeclarations )
      prior.init( existing )
      if (existing.list) list = existing.list.cloned
      if (existing.type) type = existing.type.cloned
      if (existing.attributes) attributes = existing.attributes.cloned
      doc = existing.doc

    method description->String
      return "GlobalPropertyDeclarations($,$,$,$)" (%list,%type,%attributes,%doc)

endClass

class IDList : CmdList
  METHODS
    method description->String
      return "IDList" + list_description
endClass

class Identifier : Cmd
  PROPERTIES
    name : String

  METHODS
    method init( t, name )

    method init( existing:Identifier )
      prior.init( existing )
      name = existing.name

    method description->String
      return "Identifier($)" (%name)

    method to->Character
      return Cmd.to_character(name)

    method to->Int:     return name
    method to->Logical: return name?
    method to->String: return name

endClass

class Identifiers : CmdList
  METHODS
    method description->String
      return "Identifiers" + list_description
endClass

class If : Conditional
  PROPERTIES
    cmd_else : Cmd

  METHODS
    method init( t, condition, statements, cmd_else )

    method init( existing:If )
      prior.init( existing )
      if (existing.cmd_else) cmd_else = existing.cmd_else.cloned

    method description->String
      return "If($,$,$)" (%condition,%statements,%cmd_else)

endClass

class IfConditionalContext : Cmd
  PROPERTIES
    conditional_context : ConditionalContext
    statements          : Cmd

  METHODS
    method init( t, conditional_context, statements )

    method init( existing:IfConditionalContext )
      prior.init( existing )
      if (existing.conditional_context) conditional_context = existing.conditional_context.cloned
      if (existing.statements) statements = existing.statements.cloned

    method description->String
      return "IfConditionalContext($,$)" (%conditional_context,%statements)

endClass

class IfLocal : Cmd
  PROPERTIES
    name       : String
    expression : Cmd
    statements : Cmd
    else_if    : IfLocal

  METHODS
    method init( t, name, expression, statements, else_if )

    method init( existing:IfLocal )
      prior.init( existing )
      name = existing.name
      if (existing.expression) expression = existing.expression.cloned
      if (existing.statements) statements = existing.statements.cloned
      if (existing.else_if) else_if = existing.else_if.cloned

    method description->String
      return "IfLocal($,$,$,$)" (%name,%expression,%statements,%else_if)

endClass

class IncrementGlobalProperty : Cmd
  PROPERTIES
    info : Property

  METHODS
    method init( t, info )

    method init( existing:IncrementGlobalProperty )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "IncrementGlobalProperty($)" (%info)

endClass

class IncrementLocal : Cmd
  PROPERTIES
    info : Local

  METHODS
    method init( t, info )

    method init( existing:IncrementLocal )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "IncrementLocal($)" (%info)

endClass

class IncrementProperty : Cmd
  PROPERTIES
    context : Cmd
    info    : Property

  METHODS
    method init( t, context, info )

    method init( existing:IncrementProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      if (existing.info) info = existing.info.cloned

    method description->String
      return "IncrementProperty($,$)" (%context,%info)

endClass

class IncrementThisProperty : Cmd
  PROPERTIES
    info : Property

  METHODS
    method init( t, info )

    method init( existing:IncrementThisProperty )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "IncrementThisProperty($)" (%info)

endClass

class IndexedAccess : Cmd
  PROPERTIES
    context : Cmd
    index   : Cmd

  METHODS
    method init( t, context, index )

    method init( existing:IndexedAccess )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      if (existing.index) index = existing.index.cloned

    method description->String
      return "IndexedAccess($,$)" (%context,%index)

endClass

class InlineAssignment : Cmd
  PROPERTIES
    info  : Local
    value : Cmd

  METHODS
    method init( t, info, value )

    method init( existing:InlineAssignment )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned
      if (existing.value) value = existing.value.cloned

    method description->String
      return "InlineAssignment($,$)" (%info,%value)

endClass

class InlineWhich : Cmd
  PROPERTIES
    cases : InlineWhichCases

  METHODS
    method init( t, cases )

    method init( existing:InlineWhich )
      prior.init( existing )
      if (existing.cases) cases = existing.cases.cloned

    method description->String
      return "InlineWhich($)" (%cases)

endClass

class InlineWhichCase : Cmd
  PROPERTIES
    condition : Cmd
    value     : Cmd

  METHODS
    method init( t, condition, value )

    method init( existing:InlineWhichCase )
      prior.init( existing )
      if (existing.condition) condition = existing.condition.cloned
      if (existing.value) value = existing.value.cloned

    method description->String
      return "InlineWhichCase($,$)" (%condition,%value)

endClass

class InlineWhichCases : CmdList
  METHODS
    method description->String
      return "InlineWhichCases" + list_description
endClass

class InstanceOf : Cmd
  PROPERTIES
    operand      : Cmd
    compare_type : Type

  METHODS
    method init( t, operand, compare_type )

    method init( existing:InstanceOf )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned
      if (existing.compare_type) compare_type = existing.compare_type.cloned

    method description->String
      return "InstanceOf($,$)" (%operand,%compare_type)

endClass

class IntrospectionGetObjectProperty : Cmd
  PROPERTIES
    info    : Property
    context : Cmd

  METHODS
    method init( t, info, context )

    method init( existing:IntrospectionGetObjectProperty )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned
      if (existing.context) context = existing.context.cloned

    method description->String
      return "IntrospectionGetObjectProperty($,$)" (%info,%context)

endClass

class Is : Binary
  METHODS
    method description->String
      return "Is($,$)" (%left,%right)

endClass

class IsCompound : Cmd
  PROPERTIES
    operand : Cmd

  METHODS
    method init( t, operand )

    method init( existing:IsCompound )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "IsCompound($)" (%operand)

endClass

class IsEnum : Cmd
  PROPERTIES
    operand : Cmd

  METHODS
    method init( t, operand )

    method init( existing:IsEnum )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "IsEnum($)" (%operand)

endClass

class IsNot : Binary
  METHODS
    method description->String
      return "IsNot($,$)" (%left,%right)

endClass

class IsPrimitive : Cmd
  PROPERTIES
    operand : Cmd

  METHODS
    method init( t, operand )

    method init( existing:IsPrimitive )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "IsPrimitive($)" (%operand)

endClass

class IsReference : Cmd
  PROPERTIES
    operand : Cmd

  METHODS
    method init( t, operand )

    method init( existing:IsReference )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "IsReference($)" (%operand)

endClass

class IsType : Cmd
  PROPERTIES
    operand      : Cmd
    compare_type : Type

  METHODS
    method init( t, operand, compare_type )

    method init( existing:IsType )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned
      if (existing.compare_type) compare_type = existing.compare_type.cloned

    method description->String
      return "IsType($,$)" (%operand,%compare_type)

endClass

class Iterator : Conditional
  PROPERTIES
    control : Cmd
    upkeep  : Cmd

  METHODS
    method init( t, control, condition, statements, upkeep )

    method init( existing:Iterator )
      prior.init( existing )
      if (existing.control) control = existing.control.cloned
      if (existing.upkeep) upkeep = existing.upkeep.cloned

    method description->String
      return "Iterator($,$,$,$)" (%control,%condition,%statements,%upkeep)

endClass

class KeyValuePair : Cmd
  PROPERTIES
    key   : Cmd
    value : Cmd

  METHODS
    method init( t, key, value )

    method init( existing:KeyValuePair )
      prior.init( existing )
      if (existing.key) key = existing.key.cloned
      if (existing.value) value = existing.value.cloned

    method description->String
      return "KeyValuePair($,$)" (%key,%value)

endClass

class KeyValuePairList : CmdList
  METHODS
    method description->String
      return "KeyValuePairList" + list_description
endClass

class LiteralCharacter : LiteralPrimitive
  PROPERTIES
    value : Character

  METHODS
    method init( t, value )

    method init( existing:LiteralCharacter )
      prior.init( existing )
      value = existing.value

    method description->String
      return "LiteralCharacter($)" (%value)

    method to->Character: return value
    method to->Int:       return value
    method to->String:    return value

endClass

class LiteralInt : LiteralPrimitive
  PROPERTIES
    content : String
    value   : Int
    base    : Int

  METHODS
    method init( t, content, base )
      value = content->Int( base )

    method init( t, value )

    method init( existing:LiteralInt )
      prior.init( existing )
      content = existing.content
      base = existing.base
      value = existing.value

    method description->String
      if (content) return "LiteralInt($,$)" (%content,%base)
      else         return value

endClass

class LiteralList : CmdList
  METHODS
    method description->String
      return "LiteralList" + list_description
endClass

class LiteralLogical : LiteralPrimitive
  PROPERTIES
    value : Logical

  METHODS
    method init( t, value )

    method init( existing:LiteralLogical )
      prior.init( existing )
      value = existing.value

    method description->String
      return "LiteralLogical($)" (%value)

    method to->Int:     return which{value:1 || 0}
    method to->Logical: return value
    method to->String:  return which{value:"true" || "false"}

endClass

class LiteralNull : Literal
  METHODS
    method description->String
      return "LiteralNull"
endClass

class LiteralNullOptional : Literal
  PROPERTIES
    optional_type : Type

  METHODS
    method init( t, optional_type )

    method init( existing:LiteralNullOptional )
      prior.init( existing )
      if (existing.optional_type) optional_type = existing.optional_type.cloned

    method description->String
      return "LiteralNullOptional($)" (%optional_type)

endClass

class LiteralPi : Literal
  METHODS
    method description->String
      return "LiteralPi"
endClass

class LiteralUndefined : Cmd
  METHODS
    method description->String
      return "LiteralUndefined"
endClass

class Local : Cmd
  PROPERTIES
    name                 : String
    initial_value        : Cmd
    initial_value_tokens : TokenList
    type                 : Type
    attribute            : String
    index                : Int  # stack index within procedure

  METHODS
    method init( t, name, initial_value, initial_value_tokens, type, attribute )

    method init( t, name, initial_value, initial_value_tokens, type )

    method init( t, name, type )

    method init( existing:Local )
      prior.init( existing )
      name = existing.name
      if (existing.initial_value) initial_value = existing.initial_value.cloned
      if (existing.initial_value_tokens) initial_value_tokens = existing.initial_value_tokens.cloned
      if (existing.type) type = existing.type.cloned
      attribute = existing.attribute

    method description->String
      return "Local($,$,$,$,$)" (%name,%initial_value,%initial_value_tokens,%type,%attribute)

endClass

class LocalDeclaration : Cmd
  PROPERTIES
    info : Local

  METHODS
    method init( t, info )

    method init( existing:LocalDeclaration )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "LocalDeclaration($)" (%info)

endClass

class LogicalAnd : LogicalBinary
  METHODS
    method description->String
      return "LogicalAnd($,$)" (%left,%right)

endClass

class LogicalNot : LogicalUnary
  METHODS
    method description->String
      return "LogicalNot($)" (%operand)

endClass

class LogicalOr : LogicalBinary
  METHODS
    method description->String
      return "LogicalOr($,$)" (%left,%right)

endClass

class LogicalXor : LogicalBinary
  METHODS
    method description->String
      return "LogicalXor($,$)" (%left,%right)

endClass

class Logicalize : Unary
  METHODS
    method description->String
      return "Logicalize($)" (%operand)

endClass

class Logicalized : Unary
  METHODS
    method description->String
      return "Logicalized($)" (%operand)

endClass

class Loop : Cmd
  PROPERTIES
    loop_count : Cmd
    statements : Cmd

  METHODS
    method init( t, loop_count, statements )

    method init( existing:Loop )
      prior.init( existing )
      if (existing.loop_count) loop_count = existing.loop_count.cloned
      if (existing.statements) statements = existing.statements.cloned

    method description->String
      return "Loop($,$)" (%loop_count,%statements)

endClass

class Method : Procedure
  METHODS
    method description->String
      return "Method($,$,$,$,$,$)" (%name,%parameters,%return_type,%attributes,%doc,%statements)

endClass

class Methods : CmdList
  METHODS
    method description->String
      return "Methods" + list_description
endClass

class Mod : Binary
  METHODS
    method description->String
      return "Mod($,$)" (%left,%right)

endClass

class ModuleQualifiedID : Cmd
  PROPERTIES
    context : Cmd
    name    : String

  METHODS
    method init( t, context, name )

    method init( existing:ModuleQualifiedID )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      name = existing.name

    method description->String
      return "ModuleQualifiedID($,$)" (%context,%name)

endClass

class MultiplyAndAssignGlobalProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "MultiplyAndAssignGlobalProperty($,$)" (%info,%operand)

endClass

class MultiplyAndAssignLocal : ResolvedOpAndAssignLocal
  METHODS
    method description->String
      return "MultiplyAndAssignLocal($,$)" (%info,%operand)

endClass

class MultiplyAndAssignProperty : ResolvedOpAndAssignProperty
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, info, operand )

    method init( existing:MultiplyAndAssignProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "MultiplyAndAssignProperty($,$,$)" (%context,%info,%operand)

endClass

class MultiplyAndAssignThisProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "MultiplyAndAssignThisProperty($,$)" (%info,%operand)

endClass

class NamedArg : Cmd
  PROPERTIES
    name    : String
    value   : Cmd
    zero    : Logical
    forward : Logical

  METHODS
    method init( t, name, value, zero )

    method init( t, name, value )

    method init( t, name, value, zero, forward )

    method init( existing:NamedArg )
      prior.init( existing )
      name = existing.name
      if (existing.value) value = existing.value.cloned
      zero = existing.zero
      forward = existing.forward

    method description->String
      return "NamedArg($,$,$,$)" (%name,%value,%zero,%forward)

endClass

class NamedTuple : CmdList
  METHODS
    method description->String
      return "NamedTuple" + list_description
endClass

class NamedTupleElement : Cmd
  PROPERTIES
    name  : String
    value : Cmd

  METHODS
    method init( t, name, value )

    method init( existing:NamedTupleElement )
      prior.init( existing )
      name = existing.name
      if (existing.value) value = existing.value.cloned

    method description->String
      return "NamedTupleElement($,$)" (%name,%value)

endClass

class NamedTupleTypeElement : Cmd
  PROPERTIES
    name    : String
    of_type : Type

  METHODS
    method init( t, name, of_type )

    method init( existing:NamedTupleTypeElement )
      prior.init( existing )
      name = existing.name
      if (existing.of_type) of_type = existing.of_type.cloned

    method description->String
      return "NamedTupleTypeElement($,$)" (%name,%of_type)

endClass

class NamedTupleTypeElements : CmdList
  METHODS
    method description->String
      return "NamedTupleTypeElements" + list_description
endClass

class NativeCode : Cmd
  PROPERTIES
    ordinal : Int
    content : String

  METHODS
    method init( t, ordinal, content )

    method init( existing:NativeCode )
      prior.init( existing )
      ordinal = existing.ordinal
      content = existing.content

    method description->String
      return "NativeCode($,$)" (%ordinal,%content)

endClass

class NativeExpression : Cmd
  PROPERTIES
    content     : String
    result_type : Type

  METHODS
    method init( t, content, result_type )

    method init( existing:NativeExpression )
      prior.init( existing )
      content = existing.content
      if (existing.result_type) result_type = existing.result_type.cloned

    method description->String
      return "NativeExpression($,$)" (%content,%result_type)

endClass

class NativeHeader : Cmd
  PROPERTIES
    ordinal : Int
    content : String

  METHODS
    method init( t, ordinal, content )

    method init( existing:NativeHeader )
      prior.init( existing )
      ordinal = existing.ordinal
      content = existing.content

    method description->String
      return "NativeHeader($,$)" (%ordinal,%content)

endClass

class NativeProperty : Cmd
  PROPERTIES
    target     : String
    expression : String

  METHODS
    method init( t, target, expression )

    method init( existing:NativeProperty )
      prior.init( existing )
      target = existing.target
      expression = existing.expression

    method description->String
      return "NativeProperty($,$)" (%target,%expression)

endClass

class NativeStatement : Cmd
  PROPERTIES
    content : String

  METHODS
    method init( t, content )

    method init( existing:NativeStatement )
      prior.init( existing )
      content = existing.content

    method description->String
      return "NativeStatement($)" (%content)

    method to->Character
      return Cmd.to_character(content)

    method to->Int:     return content
    method to->Logical: return content?
    method to->String: return content

endClass

class NotInstanceOf : Cmd
  PROPERTIES
    operand      : Cmd
    compare_type : Type

  METHODS
    method init( t, operand, compare_type )

    method init( existing:NotInstanceOf )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned
      if (existing.compare_type) compare_type = existing.compare_type.cloned

    method description->String
      return "NotInstanceOf($,$)" (%operand,%compare_type)

endClass

class NotIsType : Cmd
  PROPERTIES
    operand      : Cmd
    compare_type : Type

  METHODS
    method init( t, operand, compare_type )

    method init( existing:NotIsType )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned
      if (existing.compare_type) compare_type = existing.compare_type.cloned

    method description->String
      return "NotIsType($,$)" (%operand,%compare_type)

endClass

class OpAndAssign : Cmd
  PROPERTIES
    target  : Cmd
    operand : Cmd

  METHODS
    method init( t, target, operand )

    method init( existing:OpAndAssign )
      prior.init( existing )
      if (existing.target) target = existing.target.cloned
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "OpAndAssign($,$)" (%target,%operand)

endClass

class Parameters : CmdList
  METHODS
    method get( index:Int )->Local
      return @list[index]->(as Local)

    method description->String
      return "Parameters" + list_description
endClass

class Placeholder : Cmd
  PROPERTIES
    name : String

  METHODS
    method init( t, name )

    method init( existing:Placeholder )
      prior.init( existing )
      name = existing.name

    method description->String
      return "Placeholder($)" (%name)

    method to->Character
      return Cmd.to_character(name)

    method to->Int:     return name
    method to->Logical: return name?
    method to->String: return name

endClass

class Power : Binary
  METHODS
    method description->String
      return "Power($,$)" (%left,%right)

endClass

class PreDecrementLocal : Cmd
  PROPERTIES
    info : Local

  METHODS
    method init( t, info )

    method init( existing:PreDecrementLocal )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "PreDecrementLocal($)" (%info)

endClass

class Procedure : ControlStructure
  PROPERTIES
    type_context   : Type
    name           : String
    parameters     : Parameters
    return_type    : Type
    attributes     : Attributes
    doc            : String
    _signature     : String
    param_count    : Int  # Includes 'this' context.
    local_count    : Int  # Count of all non-parameter locals in this scope and all nested scopes.

  METHODS
    method init( t, name, parameters, return_type, attributes, doc, statements )

    method init( t, name, parameters=null, return_type=null, statements=null )
      if (not statements) statements = Statements( t )

    method init( existing:Procedure )
      prior.init( existing )
      name = existing.name
      if (existing.parameters) parameters = existing.parameters.cloned
      if (existing.return_type) return_type = existing.return_type.cloned
      if (existing.attributes) attributes = existing.attributes.cloned
      doc = existing.doc

    method description->String
      return "$($,$,$,$,$,$)" (type_name,%name,%parameters,%return_type,%attributes,%doc,%statements)

    method signature->String
      if (_signature) return _signature

      _signature = String()
      _signature.print( name )
      _signature.print( '(' )
      if (parameters)
        forEach (param at i in parameters)
          assert param.type
          if (i) _signature.print ','
          _signature.print param.type
        endForEach
      endIf
      _signature.print( ')' )
      return _signature

endClass

class Property : Cmd
  PROPERTIES
    name          : String
    initial_value : Cmd
    type          : Type

  METHODS
    method init( t, name, initial_value, type )

    method init( existing:Property )
      prior.init( existing )
      name = existing.name
      if (existing.initial_value) initial_value = existing.initial_value.cloned
      if (existing.type) type = existing.type.cloned

    method description->String
      return "Property($,$,$)" (%name,%initial_value,%type)

endClass

class PropertyDeclarations : Cmd
  PROPERTIES
    list : Cmd
    type         : Type
    attributes   : Attributes
    doc          : String

  METHODS
    method init( t, list, type, attributes, doc )

    method init( existing:PropertyDeclarations )
      prior.init( existing )
      if (existing.list) list = existing.list.cloned
      if (existing.type) type = existing.type.cloned
      if (existing.attributes) attributes = existing.attributes.cloned
      doc = existing.doc

    method description->String
      return "PropertyDeclarations($,$,$,$)" (%list,%type,%attributes,%doc)

endClass

class PushStackTraceCutoff : Cmd
  METHODS
    method description->String
      return "PushStackTraceCutoff"
endClass

class ResolvedOpAndAssignLocal : Cmd
  PROPERTIES
    info    : Local
    operand : Cmd

  METHODS
    method init( t, info, operand )

    method init( existing:ResolvedOpAndAssignLocal )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "ResolvedOpAndAssignLocal($,$)" (%info,%operand)

endClass

class ResolvedOpAndAssignProperty : Cmd
  PROPERTIES
    info    : Property
    operand : Cmd

  METHODS
    method init( t, info, operand )

    method init( existing:ResolvedOpAndAssignProperty )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "ResolvedOpAndAssignProperty($,$)" (%info,%operand)

endClass

class ReturnOnException : Cmd
  METHODS
    method description->String
      return "ReturnOnException"
endClass

class SetGlobalProperty : Cmd
  PROPERTIES
    info      : Property
    new_value : Cmd

  METHODS
    method init( t, info, new_value )

    method init( existing:SetGlobalProperty )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned
      if (existing.new_value) new_value = existing.new_value.cloned

    method description->String
      return "SetGlobalProperty($,$)" (%info,%new_value)

endClass

class SetLocal : Cmd
  PROPERTIES
    info      : Local
    new_value : Cmd

  METHODS
    method init( t, info, new_value )

    method init( existing:SetLocal )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned
      if (existing.new_value) new_value = existing.new_value.cloned

    method description->String
      return "SetLocal($,$)" (%info,%new_value)

endClass

class SetProperty : Cmd
  PROPERTIES
    context   : Cmd
    info      : Property
    new_value : Cmd

  METHODS
    method init( t, context, info, new_value )

    method init( existing:SetProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      if (existing.info) info = existing.info.cloned
      if (existing.new_value) new_value = existing.new_value.cloned

    method description->String
      return "SetProperty($,$,$)" (%context,%info,%new_value)

endClass

class SetSingleton : Cmd
  PROPERTIES
    of_type   : Type
    new_value : Cmd

  METHODS
    method init( t, of_type, new_value )

    method init( existing:SetSingleton )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned
      if (existing.new_value) new_value = existing.new_value.cloned

    method description->String
      return "SetSingleton($,$)" (%of_type,%new_value)

endClass

class SetThisProperty : Cmd
  PROPERTIES
    info      : Property
    new_value : Cmd

  METHODS
    method init( t, info, new_value )

    method init( existing:SetThisProperty )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned
      if (existing.new_value) new_value = existing.new_value.cloned

    method description->String
      return "SetThisProperty($,$)" (%info,%new_value)

endClass

class StateDef : Cmd
  PROPERTIES
    name    : String
    methods : Methods

  METHODS
    method init( t, name, methods )

    method init( existing:StateDef )
      prior.init( existing )
      name = existing.name
      if (existing.methods) methods = existing.methods.cloned

    method description->String
      return "StateDef($,$)" (%name,%methods)

endClass

class Stepper : Cmd
  PROPERTIES
    operand : Cmd

  METHODS
    method init( t, operand )

    method init( existing:Stepper )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "Stepper($)" (%operand)

endClass

class SubtractAndAssignGlobalProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "SubtractAndAssignGlobalProperty($,$)" (%info,%operand)

endClass

class SubtractAndAssignLocal : ResolvedOpAndAssignLocal
  METHODS
    method description->String
      return "SubtractAndAssignLocal($,$)" (%info,%operand)

endClass

class SubtractAndAssignProperty : ResolvedOpAndAssignProperty
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, info, operand )

    method init( existing:SubtractAndAssignProperty )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "SubtractAndAssignProperty($,$,$)" (%context,%info,%operand)

endClass

class SubtractAndAssignThisProperty : ResolvedOpAndAssignProperty
  METHODS
    method description->String
      return "SubtractAndAssignThisProperty($,$)" (%info,%operand)

endClass

class Switch : Conditional
  PROPERTIES
    cases : WhichCases

  METHODS
    method init( t, condition, cases, statements )

    method init( existing:Switch )
      prior.init( existing )
      if (existing.cases) cases = existing.cases.cloned

    method description->String
      return "Switch($,$,$)" (%condition,%cases,%statements)

endClass

class Temporarily : ControlStructure
  PROPERTIES
    assignments : TemporaryAssignments

  METHODS
    method init( t, assignments, statements )

    method init( existing:Temporarily )
      prior.init( existing )
      if (existing.assignments) assignments = existing.assignments.cloned

    method description->String
      return "Temporarily($,$)" (%assignments,%statements)

endClass

class TemporaryAssignment : Cmd
  PROPERTIES
    target    : Cmd
    new_value : Cmd

  METHODS
    method init( t, target, new_value )

    method init( existing:TemporaryAssignment )
      prior.init( existing )
      if (existing.target) target = existing.target.cloned
      if (existing.new_value) new_value = existing.new_value.cloned

    method description->String
      return "TemporaryAssignment($,$)" (%target,%new_value)

endClass

class TemporaryAssignments : CmdList
  METHODS
    method description->String
      return "TemporaryAssignments" + list_description
endClass

class This : Cmd
  METHODS
    method description->String
      return "This"
endClass

class TracedExpression : Cmd
  PROPERTIES
    expression : Cmd
    token_list : TokenList

  METHODS
    method init( t, expression, token_list )

    method init( existing:TracedExpression )
      prior.init( existing )
      if (existing.expression) expression = existing.expression.cloned
      if (existing.token_list) token_list = existing.token_list.cloned

    method description->String
      return "TracedExpression($,$)" (%expression,%token_list)

endClass

class TracedExpressions : CmdList
  METHODS
    method description->String
      return "TracedExpressions" + list_description
endClass

class Try : ControlStructure
  PROPERTIES
    catches : Catches

  METHODS
    method init( t, statements, catches )

    method init( existing:Try )
      prior.init( existing )
      if (existing.catches) catches = existing.catches.cloned

    method description->String
      return "Try($,$)" (%statements,%catches)

endClass

class TypeContext : Cmd
  PROPERTIES
    type : Type

  METHODS
    method init( t, type )

    method init( existing:TypeContext )
      prior.init( existing )
      if (existing.type) type = existing.type.cloned

    method description->String
      return "TypeContext($)" (%type)

endClass

class TypeIndex : Cmd
  PROPERTIES
    of_type : Type

  METHODS
    method init( t, of_type )

    method init( existing:TypeIndex )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned

    method description->String
      return "TypeIndex($)" (%of_type)

endClass

class TypeList : CmdList
  METHODS
    method description->String
      return "TypeList" + list_description
endClass

class TypedDestructuringLocal : Cmd
  PROPERTIES
    name : String
    type : Type

  METHODS
    method init( t, name, type )

    method init( existing:TypedDestructuringLocal )
      prior.init( existing )
      name = existing.name
      if (existing.type) type = existing.type.cloned

    method description->String
      return "TypedDestructuringLocal($,$)" (%name,%type)

endClass

class TypedDestructuringLocalDeclarations : Cmd
  PROPERTIES
    locals : TypedDestructuringLocals
    tuple  : Cmd

  METHODS
    method init( t, locals, tuple )

    method init( existing:TypedDestructuringLocalDeclarations )
      prior.init( existing )
      if (existing.locals) locals = existing.locals.cloned
      if (existing.tuple) tuple = existing.tuple.cloned

    method description->String
      return "TypedDestructuringLocalDeclarations($,$)" (%locals,%tuple)

endClass

class TypedDestructuringLocals : CmdList
  METHODS
    method description->String
      return "TypedDestructuringLocals" + list_description
endClass

class TypedLiteralList : Cmd
  PROPERTIES
    of_type : Type
    list    : Cmd

  METHODS
    method init( t, of_type, list )

    method init( existing:TypedLiteralList )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned
      if (existing.list) list = existing.list.cloned

    method description->String
      return "TypedLiteralList($,$)" (%of_type,%list)

endClass

class TypedLiteralTable : Cmd
  PROPERTIES
    of_type : Type
    table   : KeyValuePairList

  METHODS
    method init( t, of_type, table )

    method init( existing:TypedLiteralTable )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned
      if (existing.table) table = existing.table.cloned

    method description->String
      return "TypedLiteralTable($,$)" (%of_type,%table)

endClass

class UntypedDestructuringLocalDeclarations : Cmd
  PROPERTIES
    locals : Identifiers
    tuple  : Cmd

  METHODS
    method init( t, locals, tuple )

    method init( existing:UntypedDestructuringLocalDeclarations )
      prior.init( existing )
      if (existing.locals) locals = existing.locals.cloned
      if (existing.tuple) tuple = existing.tuple.cloned

    method description->String
      return "UntypedDestructuringLocalDeclarations($,$)" (%locals,%tuple)

endClass

class Use : ControlStructure
  PROPERTIES
    resources : UsedResources

  METHODS
    method init( t, resources, statements )

    method init( existing:Use )
      prior.init( existing )
      if (existing.resources) resources = existing.resources.cloned

    method description->String
      return "Use($,$)" (%resources,%statements)

endClass

class UsedResource : Cmd
  PROPERTIES
    name     : String
    resource : Cmd

  METHODS
    method init( t, name, resource )

    method init( existing:UsedResource )
      prior.init( existing )
      name = existing.name
      if (existing.resource) resource = existing.resource.cloned

    method description->String
      return "UsedResource($,$)" (%name,%resource)

endClass

class UsedResources : CmdList
  METHODS
    method description->String
      return "UsedResources" + list_description
endClass

class VariantTable : Cmd
  PROPERTIES
    args : KeyValuePairList

  METHODS
    method init( t, args )

    method init( existing:VariantTable )
      prior.init( existing )
      if (existing.args) args = existing.args.cloned

    method description->String
      return "VariantTable($)" (%args)

endClass

class VerboseTrace : Cmd
  PROPERTIES
    expressions : TracedExpressions

  METHODS
    method init( t, expressions )

    method init( existing:VerboseTrace )
      prior.init( existing )
      if (existing.expressions) expressions = existing.expressions.cloned

    method description->String
      return "VerboseTrace($)" (%expressions)

endClass

class Which : Conditional
  PROPERTIES
    cases : WhichCases

  METHODS
    method init( t, condition, cases, statements )

    method init( existing:Which )
      prior.init( existing )
      if (existing.cases) cases = existing.cases.cloned

    method description->String
      return "Which($,$,$)" (%condition,%cases,%statements)

endClass

class WhichCases : CmdList
  METHODS
    method description->String
      return "WhichCases" + list_description
endClass

class WideningCast : Cmd
  PROPERTIES
    operand : Cmd
    to_type : Type

  METHODS
    method init( t, operand, to_type )

    method init( existing:WideningCast )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned
      if (existing.to_type) to_type = existing.to_type.cloned

    method description->String
      return "WideningCast($,$)" (%operand,%to_type)

endClass

class WithValue : Cmd
  PROPERTIES
    name  : String
    value : Cmd

  METHODS
    method init( t, name, value )

    method init( existing:WithValue )
      prior.init( existing )
      name = existing.name
      if (existing.value) value = existing.value.cloned

    method description->String
      return "WithValue($,$)" (%name,%value)

endClass

class WithValues : CmdList
  METHODS
    method description->String
      return "WithValues" + list_description
endClass

class AccessAndAssign : Cmd
  PROPERTIES
    operand : Cmd

  METHODS
    method init( t, operand )

    method init( existing:AccessAndAssign )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned

    method description->String
      return "AccessAndAssign($)" (%operand)

endClass

class AccessAndAssignContext : Cmd
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context )

    method init( existing:AccessAndAssignContext )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "AccessAndAssignContext($)" (%context)

endClass

class AddAndAssign : OpAndAssign
  METHODS
    method description->String
      return "AddAndAssign($,$)" (%target,%operand)

endClass

class Assert : Cmd
  PROPERTIES
    expression : Cmd
    token_list : TokenList

  METHODS
    method init( t, expression, token_list )

    method init( existing:Assert )
      prior.init( existing )
      if (existing.expression) expression = existing.expression.cloned
      if (existing.token_list) token_list = existing.token_list.cloned

    method description->String
      return "Assert($,$)" (%expression,%token_list)

endClass

class BitShiftLeftAndAssign : OpAndAssign
  METHODS
    method description->String
      return "BitShiftLeftAndAssign($,$)" (%target,%operand)

endClass

class BitShiftRightAndAssign : OpAndAssign
  METHODS
    method description->String
      return "BitShiftRightAndAssign($,$)" (%target,%operand)

endClass

class BitShiftRightXAndAssign : OpAndAssign
  METHODS
    method description->String
      return "BitShiftRightXAndAssign($,$)" (%target,%operand)

endClass

class BitwiseAndAndAssign : OpAndAssign
  METHODS
    method description->String
      return "BitwiseAndAndAssign($,$)" (%target,%operand)

endClass

class BitwiseOrAndAssign : OpAndAssign
  METHODS
    method description->String
      return "BitwiseOrAndAssign($,$)" (%target,%operand)

endClass

class BitwiseXorAndAssign : OpAndAssign
  METHODS
    method description->String
      return "BitwiseXorAndAssign($,$)" (%target,%operand)

endClass

class ConditionalContext : Cmd
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context )

    method init( existing:ConditionalContext )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "ConditionalContext($)" (%context)

endClass

class Decrement : Stepper
  METHODS
    method description->String
      return "Decrement($)" (%operand)

endClass

class DefineModule : Cmd
  PROPERTIES
    name       : String
    attributes : Attributes

  METHODS
    method init( t, name, attributes )

    method init( existing:DefineModule )
      prior.init( existing )
      name = existing.name
      if (existing.attributes) attributes = existing.attributes.cloned

    method description->String
      return "DefineModule($,$)" (%name,%attributes)

endClass

class DivideAndAssign : OpAndAssign
  METHODS
    method description->String
      return "DivideAndAssign($,$)" (%target,%operand)

endClass

class EscapeBlock : Escape
  METHODS
    method description->String
      return "EscapeBlock"
endClass

class EscapeContingent : Escape
  METHODS
    method description->String
      return "EscapeContingent"
endClass

class EscapeForEach : Escape
  METHODS
    method description->String
      return "EscapeForEach"
endClass

class EscapeIf : Escape
  METHODS
    method description->String
      return "EscapeIf"
endClass

class EscapeLoop : Escape
  METHODS
    method description->String
      return "EscapeLoop"
endClass

class EscapeTry : Escape
  METHODS
    method description->String
      return "EscapeTry"
endClass

class EscapeWhich : Escape
  METHODS
    method description->String
      return "EscapeWhich"
endClass

class EscapeWhile : Escape
  METHODS
    method description->String
      return "EscapeWhile"
endClass

class Increment : Stepper
  METHODS
    method description->String
      return "Increment($)" (%operand)

endClass

class ModAndAssign : OpAndAssign
  METHODS
    method description->String
      return "ModAndAssign($,$)" (%target,%operand)

endClass

class MultiplyAndAssign : OpAndAssign
  METHODS
    method description->String
      return "MultiplyAndAssign($,$)" (%target,%operand)

endClass

class Necessary : Cmd
  PROPERTIES
    condition : Cmd

  METHODS
    method init( t, condition )

    method init( existing:Necessary )
      prior.init( existing )
      if (existing.condition) condition = existing.condition.cloned

    method description->String
      return "Necessary($)" (%condition)

endClass

class NextIteration : Cmd
  METHODS
    method description->String
      return "NextIteration"
endClass

class Placeholders : CmdList
  METHODS
    method description->String
      return "Placeholders" + list_description
endClass

class PowerAndAssign : OpAndAssign
  METHODS
    method description->String
      return "PowerAndAssign($,$)" (%target,%operand)

endClass

class Return : Cmd
  PROPERTIES
    result : Cmd

  METHODS
    method init( t, result )

    method init( existing:Return )
      prior.init( existing )
      if (existing.result) result = existing.result.cloned

    method description->String
      return "Return($)" (%result)

endClass

class SubtractAndAssign : OpAndAssign
  METHODS
    method description->String
      return "SubtractAndAssign($,$)" (%target,%operand)

endClass

class Sufficient : Cmd
  PROPERTIES
    condition : Cmd

  METHODS
    method init( t, condition )

    method init( existing:Sufficient )
      prior.init( existing )
      if (existing.condition) condition = existing.condition.cloned

    method description->String
      return "Sufficient($)" (%condition)

endClass

class SwapValues : Cmd
  PROPERTIES
    a : Cmd
    b : Cmd

  METHODS
    method init( t, a, b )

    method init( existing:SwapValues )
      prior.init( existing )
      if (existing.a) a = existing.a.cloned
      if (existing.b) b = existing.b.cloned

    method description->String
      return "SwapValues($,$)" (%a,%b)

endClass

class Throw : Cmd
  PROPERTIES
    exception : Cmd

  METHODS
    method init( t, exception )

    method init( existing:Throw )
      prior.init( existing )
      if (existing.exception) exception = existing.exception.cloned

    method description->String
      return "Throw($)" (%exception)

endClass

class NativeLiteralInt : NativeExpression
  METHODS
    method init( t:Token, content:String )
      prior.init( t, content, Program.type_Int )

    method init( other:NativeLiteralInt )
      prior.init( other )

    method description->String
      return "NativeLiteralInt($)" (%content)

endClass

class Assign : Cmd
  PROPERTIES
    target    : Cmd
    new_value : Cmd

  METHODS
    method init( t, target, new_value )

    method init( existing:Assign )
      prior.init( existing )
      if (existing.target) target = existing.target.cloned
      if (existing.new_value) new_value = existing.new_value.cloned

    method description->String
      return "Assign($,$)" (%target,%new_value)

endClass

class LocalList : CmdList
  METHODS
    method get( index:Int )->Local
      return @list[index]->(as Local)

    method description->String
      return "LocalList" + list_description
endClass


class LocalDeclarations : Cmd
  PROPERTIES
    list : LocalList
    type : Type

  METHODS
    method init( t, list, type )

    method init( existing:LocalDeclarations )
      prior.init( existing )
      if (existing.list) list = existing.list.cloned
      if (existing.type) type = existing.type.cloned

    method description->String
      return "LocalDeclarations($,$)" (%list,%type)

endClass


class WriteLocal : Cmd
  PROPERTIES
    info      : Local
    new_value : Cmd

  METHODS
    method init( t, info, new_value )

    method init( existing:WriteLocal )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned
      if (existing.new_value) new_value = existing.new_value.cloned

    method description->String
      return "WriteLocal($,$)" (%info,%new_value)

endClass

class SetLocalToDefaultValue : Cmd
  PROPERTIES
    info : Local

  METHODS
    method init( t, info )

    method init( existing:SetLocalToDefaultValue )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "SetLocalToDefaultValue($)" (%info)

endClass

class ReadLocal : Cmd
  PROPERTIES
    info : Local

  METHODS
    method init( t, info )

    method init( existing:ReadLocal )
      prior.init( existing )
      if (existing.info) info = existing.info.cloned

    method description->String
      return "ReadLocal($)" (%info)

endClass

class ReadLocalInt : ReadLocal
  METHODS
    method description->String
      return "ReadLocalInt($)" (%info)

endClass

class AddInt : Add
  METHODS
    method description->String
      return "AddInt($,$)" (%left,%right)

endClass


class LiteralReal : LiteralPrimitive
  PROPERTIES
    value : Real

  METHODS
    method init( t, value )

    method init( existing:LiteralReal )
      prior.init( existing )
      value = existing.value

    method description->String
      return "LiteralReal($)" (%value)

    method to->Int:    return value
    method to->Real:   return value
    method to->String: return value

endClass


class IntToReal : Unary
  METHODS
    method description->String
      return "IntToReal($)" (%operand)

endClass

class AddReal : Add
  METHODS
    method description->String
      return "AddReal($,$)" (%left,%right)

endClass


class WriteLocalInt : WriteLocal
  METHODS
    method description->String
      return "WriteLocalInt($,$)" (%info,%new_value)

endClass

class SubtractInt : Add
  METHODS
    method description->String
      return "SubtractInt($,$)" (%left,%right)

endClass

class SubtractReal : Add
  METHODS
    method description->String
      return "SubtractReal($,$)" (%left,%right)

endClass


class CompareEQInt : CompareEQ
  METHODS
    method description->String
      return "CompareEQInt($,$)" (%left,%right)

endClass

class CompareEQReal : CompareEQ
  METHODS
    method description->String
      return "CompareEQReal($,$)" (%left,%right)

endClass

class CompareGEInt : CompareGE
  METHODS
    method description->String
      return "CompareGEInt($,$)" (%left,%right)

endClass

class CompareGEReal : CompareGE
  METHODS
    method description->String
      return "CompareGEReal($,$)" (%left,%right)

endClass

class CompareGTInt : CompareGT
  METHODS
    method description->String
      return "CompareGTInt($,$)" (%left,%right)

endClass

class CompareGTReal : CompareGT
  METHODS
    method description->String
      return "CompareGTReal($,$)" (%left,%right)

endClass

class CompareLEInt : CompareLE
  METHODS
    method description->String
      return "CompareLEInt($,$)" (%left,%right)

endClass

class CompareLEReal : CompareLE
  METHODS
    method description->String
      return "CompareLEReal($,$)" (%left,%right)

endClass

class CompareLTInt : CompareLT
  METHODS
    method description->String
      return "CompareLTInt($,$)" (%left,%right)

endClass

class CompareLTReal : CompareLT
  METHODS
    method description->String
      return "CompareLTReal($,$)" (%left,%right)

endClass

class CompareNEInt : CompareNE
  METHODS
    method description->String
      return "CompareNEInt($,$)" (%left,%right)

endClass

class CompareNEReal : CompareNE
  METHODS
    method description->String
      return "CompareNEReal($,$)" (%left,%right)

endClass

class DivideInt : Divide
  METHODS
    method description->String
      return "DivideInt($,$)" (%left,%right)

endClass

class DivideReal : Divide
  METHODS
    method description->String
      return "DivideReal($,$)" (%left,%right)

endClass

class ModInt : Mod
  METHODS
    method description->String
      return "ModInt($,$)" (%left,%right)

endClass

class ModReal : Mod
  METHODS
    method description->String
      return "ModReal($,$)" (%left,%right)

endClass

class MultiplyInt : Multiply
  METHODS
    method description->String
      return "MultiplyInt($,$)" (%left,%right)

endClass

class MultiplyReal : Multiply
  METHODS
    method description->String
      return "MultiplyReal($,$)" (%left,%right)

endClass

class PowerInt : Power
  METHODS
    method description->String
      return "PowerInt($,$)" (%left,%right)

endClass

class PowerReal : Power
  METHODS
    method description->String
      return "PowerReal($,$)" (%left,%right)

endClass

class While : ControlStructure
  PROPERTIES
    condition : Cmd

  METHODS
    method init( t, condition, statements )

    method init( existing:While )
      prior.init( existing )
      if (existing.condition) condition = existing.condition.cloned

    method description->String
      return "While($,$)" (%condition,%statements)

endClass

class InlineForEachIn : Cmd
  PROPERTIES
    collection     : Cmd
    starting_index : Cmd
    step_size      : Cmd

  METHODS
    method init( t, collection, starting_index, step_size )

    method init( existing:InlineForEachIn )
      prior.init( existing )
      if (existing.collection) collection = existing.collection.cloned
      if (existing.starting_index) starting_index = existing.starting_index.cloned
      if (existing.step_size) step_size = existing.step_size.cloned

    method description->String
      return "InlineForEachIn($,$,$)" (%collection,%starting_index,%step_size)

endClass

class InlineForEachOf : Cmd
  PROPERTIES
    collection     : Cmd
    starting_index : Cmd
    step_size      : Cmd

  METHODS
    method init( t, collection, starting_index, step_size )

    method init( existing:InlineForEachOf )
      prior.init( existing )
      if (existing.collection) collection = existing.collection.cloned
      if (existing.starting_index) starting_index = existing.starting_index.cloned
      if (existing.step_size) step_size = existing.step_size.cloned

    method description->String
      return "InlineForEachOf($,$,$)" (%collection,%starting_index,%step_size)

endClass

class ForEachAnonymous : ControlStructure
  PROPERTIES
    collection_name : Cmd
    collection      : Cmd
    starting_index  : Cmd
    step_size       : Cmd

  METHODS
    method init( t, collection_name, collection, starting_index, step_size, statements )

    method init( existing:ForEachAnonymous )
      prior.init( existing )
      if (existing.collection_name) collection_name = existing.collection_name.cloned
      if (existing.collection) collection = existing.collection.cloned
      if (existing.starting_index) starting_index = existing.starting_index.cloned
      if (existing.step_size) step_size = existing.step_size.cloned

    method description->String
      return "ForEachAnonymous($,$,$,$,$)" (%collection_name,%collection,%starting_index,%step_size,%statements)

endClass

class ForEachIn : ControlStructure
  PROPERTIES
    element_name    : Cmd
    index_name      : Cmd
    collection_name : Cmd
    collection      : Cmd
    starting_index  : Cmd
    step_size       : Cmd

  METHODS
    method init( t, element_name, index_name, collection_name, collection, starting_index, step_size, statements )

    method init( existing:ForEachIn )
      prior.init( existing )
      if (existing.element_name) element_name = existing.element_name.cloned
      if (existing.index_name) index_name = existing.index_name.cloned
      if (existing.collection_name) collection_name = existing.collection_name.cloned
      if (existing.collection) collection = existing.collection.cloned
      if (existing.starting_index) starting_index = existing.starting_index.cloned
      if (existing.step_size) step_size = existing.step_size.cloned

    method description->String
      return "ForEachIn($,$,$,$,$,$,$)" (%element_name,%index_name,%collection_name,%collection,%starting_index,%step_size,%statements)

endClass

class ForEachOf : ControlStructure
  PROPERTIES
    index_name      : Cmd
    collection_name : Cmd
    collection      : Cmd
    starting_index  : Cmd
    step_size       : Cmd

  METHODS
    method init( t, index_name, collection_name, collection, starting_index, step_size, statements )

    method init( existing:ForEachOf )
      prior.init( existing )
      if (existing.index_name) index_name = existing.index_name.cloned
      if (existing.collection_name) collection_name = existing.collection_name.cloned
      if (existing.collection) collection = existing.collection.cloned
      if (existing.starting_index) starting_index = existing.starting_index.cloned
      if (existing.step_size) step_size = existing.step_size.cloned

    method description->String
      return "ForEachOf($,$,$,$,$,$)" (%index_name,%collection_name,%collection,%starting_index,%step_size,%statements)

endClass

class ControlStructure : Cmd
  PROPERTIES
    locals     = [String:Local]
    statements : Statements

  METHODS
    method init( t, statements )

    method init( existing:ControlStructure )
      prior.init( existing )
      if (existing.statements) statements = existing.statements.cloned

    method add_local( t:Token, name:String, type:Type, proc:Procedure )->Local
      local v = Local( t, name, type )
      add_local( v, proc )
      return v

    method add_local( identifier:Cmd, type:Type, proc:Procedure )->Local
      local v = Local( identifier.t, identifier->String, type )
      add_local( v, proc )
      return v

    method add_local( v:Local, proc:Procedure )
      if (locals.contains(v.name))
        throw v.t.error( ''A local variable named "$" already exists in the current scope.''(v.name) )
      endIf
      v.index = proc.local_count
      ++proc.local_count
      locals[v.name] = v

    method description->String
      return "ControlStructure($)" (%statements)

endClass


class ForEachElementInRangeUpToInt : ControlStructure
  PROPERTIES
    element_info : Local
    start        : Cmd
    limit        : Cmd

  METHODS
    method init( t, element_info, start, limit, statements )

    method init( existing:ForEachElementInRangeUpToInt )
      prior.init( existing )
      if (existing.element_info) element_info = existing.element_info.cloned
      if (existing.start) start = existing.start.cloned
      if (existing.limit) limit = existing.limit.cloned

    method description->String
      return "ForEachElementInRangeUpToInt($,$,$,$)" (%element_info,%start,%limit,%statements)

endClass

class LogicalBinary : Binary
  METHODS
    method description->String
      return "LogicalBinary($,$)" (%left,%right)

endClass

class LogicalUnary : Unary
  METHODS
    method description->String
      return "LogicalUnary($)" (%operand)

endClass

class Else : Cmd
  PROPERTIES
    statements : Statements

  METHODS
    method init( t, statements )

    method init( existing:Else )
      prior.init( existing )
      if (existing.statements) statements = existing.statements.cloned

    method description->String
      return "Else($)" (%statements)

endClass

class Class : Cmd
  PROPERTIES
    module_context         : Module
    name                   : Identifier
    constructor_properties : Parameters
    base_types             : TypeList
    attributes             : Attributes
    doc                    : String
    members                : Cmd

  METHODS
    method init( t, name, constructor_properties, base_types, attributes, doc, members )
      module_context = Program.current_module

    method init( existing:Class )
      prior.init( existing )
      module_context = existing.module_context
      if (existing.name) name = existing.name.cloned
      if (existing.constructor_properties) constructor_properties = existing.constructor_properties.cloned
      if (existing.base_types) base_types = existing.base_types.cloned
      if (existing.attributes) attributes = existing.attributes.cloned
      doc = existing.doc
      if (existing.members) members = existing.members.cloned

    method description->String
      return "Class($,$,$,$,$,$)" (%name,%constructor_properties,%base_types,%attributes,%doc,%members)

endClass


class ToTypeMethod : Cmd
  PROPERTIES
    to_type    : Type
    parameters : Parameters
    attributes : Attributes
    doc        : String
    statements : Statements

  METHODS
    method init( t, to_type, parameters, attributes, doc, statements )

    method init( existing:ToTypeMethod )
      prior.init( existing )
      if (existing.to_type) to_type = existing.to_type.cloned
      if (existing.parameters) parameters = existing.parameters.cloned
      if (existing.attributes) attributes = existing.attributes.cloned
      doc = existing.doc
      if (existing.statements) statements = existing.statements.cloned

    method description->String
      return "ToTypeMethod($,$,$,$,$)" (%to_type,%parameters,%attributes,%doc,%statements)

endClass

class Access : Cmd
  PROPERTIES
    name : String
    args : Args

  METHODS
    method init( t, name, args )

    method init( existing:Access )
      prior.init( existing )
      name = existing.name
      if (existing.args) args = existing.args.cloned

    method description->String
      return "Access($,$)" (%name,%args)

endClass

class CallDynamicMethod : CallProcedure
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, args )

    method init( existing:CallDynamicMethod )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "CallDynamicMethod($,$)" (%context,%args)

endClass

class CallGlobalMethod : CallProcedure
  METHODS
    method description->String
      return "CallGlobalMethod($)" (%args)

endClass

class CallMethodPointer : Cmd
  PROPERTIES
    pointer     : Cmd
    param_types : TypeList
    args        : Args
    return_type : Type

  METHODS
    method init( t, pointer, param_types, args, return_type )

    method init( existing:CallMethodPointer )
      prior.init( existing )
      if (existing.pointer) pointer = existing.pointer.cloned
      if (existing.param_types) param_types = existing.param_types.cloned
      if (existing.args) args = existing.args.cloned
      if (existing.return_type) return_type = existing.return_type.cloned

    method description->String
      return "CallMethodPointer($,$,$,$)" (%pointer,%param_types,%args,%return_type)

endClass

class CallPriorMethod : Cmd
  PROPERTIES
    name : String
    args : Args

  METHODS
    method init( t, name, args )

    method init( existing:CallPriorMethod )
      prior.init( existing )
      name = existing.name
      if (existing.args) args = existing.args.cloned

    method description->String
      return "CallPriorMethod($,$)" (%name,%args)

endClass

class CallProcedure : Cmd
  PROPERTIES
    args : Args

  METHODS
    method init( t, args )

    method init( existing:CallProcedure )
      prior.init( existing )
      if (existing.args) args = existing.args.cloned

    method description->String
      return "CallProcedure($)" (%args)

endClass

class CallStaticMethod : CallProcedure
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, args )

    method init( existing:CallStaticMethod )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "CallStaticMethod($,$)" (%context,%args)

endClass

class CallThisDynamicMethod : CallProcedure
  METHODS
    method description->String
      return "CallThisDynamicMethod($)" (%args)

endClass

class CallThisStaticMethod : CallProcedure
  METHODS
    method description->String
      return "CallThisStaticMethod($)" (%args)

endClass

class CallThisVirtualMethod : CallProcedure
  METHODS
    method description->String
      return "CallThisVirtualMethod($)" (%args)

endClass

class CallVirtualMethod : CallProcedure
  PROPERTIES
    context : Cmd

  METHODS
    method init( t, context, args )

    method init( existing:CallVirtualMethod )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned

    method description->String
      return "CallVirtualMethod($,$)" (%context,%args)

endClass

class Category : Cmd
  PROPERTIES
    name  : String
    args  : Args
    value : Cmd
    doc   : String

  METHODS
    method init( t, name, args, value, doc )

    method init( existing:Category )
      prior.init( existing )
      name = existing.name
      if (existing.args) args = existing.args.cloned
      if (existing.value) value = existing.value.cloned
      doc = existing.doc

    method description->String
      return "Category($,$,$,$)" (%name,%args,%value,%doc)

endClass

class ContextAccess : Cmd
  PROPERTIES
    context : Cmd
    name    : String
    args    : Args

  METHODS
    method init( t, context, name, args )

    method init( existing:ContextAccess )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      name = existing.name
      if (existing.args) args = existing.args.cloned

    method description->String
      return "ContextAccess($,$,$)" (%context,%name,%args)

endClass

class ConvertToTypeWithArgs : Cmd
  PROPERTIES
    operand : Cmd
    to_type : Type
    args    : Args

  METHODS
    method init( t, operand, to_type, args )

    method init( existing:ConvertToTypeWithArgs )
      prior.init( existing )
      if (existing.operand) operand = existing.operand.cloned
      if (existing.to_type) to_type = existing.to_type.cloned
      if (existing.args) args = existing.args.cloned

    method description->String
      return "ConvertToTypeWithArgs($,$,$)" (%operand,%to_type,%args)

endClass

class CreateCompound : Cmd
  PROPERTIES
    of_type : Type
    args    : Args

  METHODS
    method init( t, of_type, args )

    method init( existing:CreateCompound )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned
      if (existing.args) args = existing.args.cloned

    method description->String
      return "CreateCompound($,$)" (%of_type,%args)

endClass

class CreateObject : Cmd
  PROPERTIES
    of_type : Type
    args    : Args
    info    : Local

  METHODS
    method init( t, of_type, args )

    method init( t, of_type, info )

    method init( existing:CreateObject )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned
      if (existing.args) args = existing.args.cloned
      if (existing.info) info = existing.info.cloned

    method description->String
      return "CreateObject($,$,$)" (%of_type,%args,%info)

endClass

class Ensure : Cmd
  PROPERTIES
    expression : Cmd
    args       : Args

  METHODS
    method init( t, expression, args )

    method init( existing:Ensure )
      prior.init( existing )
      if (existing.expression) expression = existing.expression.cloned
      if (existing.args) args = existing.args.cloned

    method description->String
      return "Ensure($,$)" (%expression,%args)

endClass

class FormattedString : Cmd
  PROPERTIES
    format : String
    args   : Args

  METHODS
    method init( t, format, args )

    method init( existing:FormattedString )
      prior.init( existing )
      format = existing.format
      if (existing.args) args = existing.args.cloned

    method description->String
      return "FormattedString($,$)" (%format,%args)

endClass

class InvokeContext : Cmd
  PROPERTIES
    context : Cmd
    args    : Args

  METHODS
    method init( t, context, args )

    method init( existing:InvokeContext )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      if (existing.args) args = existing.args.cloned

    method description->String
      return "InvokeContext($,$)" (%context,%args)

endClass

class ListIndexedAccess : Cmd
  PROPERTIES
    context : Cmd
    args    : Args

  METHODS
    method init( t, context, args )

    method init( existing:ListIndexedAccess )
      prior.init( existing )
      if (existing.context) context = existing.context.cloned
      if (existing.args) args = existing.args.cloned

    method description->String
      return "ListIndexedAccess($,$)" (%context,%args)

endClass

class New : Cmd
  PROPERTIES
    type_expression : Cmd
    args            : Args

  METHODS
    method init( t, type_expression, args )

    method init( existing:New )
      prior.init( existing )
      if (existing.type_expression) type_expression = existing.type_expression.cloned
      if (existing.args) args = existing.args.cloned

    method description->String
      return "New($,$)" (%type_expression,%args)

endClass

class TypeAccess : Cmd
  PROPERTIES
    of_type : Type
    args    : Args

  METHODS
    method init( t, of_type, args )

    method init( existing:TypeAccess )
      prior.init( existing )
      if (existing.of_type) of_type = existing.of_type.cloned
      if (existing.args) args = existing.args.cloned

    method description->String
      return "TypeAccess($,$)" (%of_type,%args)

endClass

class VariantList : Cmd
  PROPERTIES
    args : Args

  METHODS
    method init( t, args )

    method init( existing:VariantList )
      prior.init( existing )
      if (existing.args) args = existing.args.cloned

    method description->String
      return "VariantList($)" (%args)

endClass

class WhichCase : Cmd
  PROPERTIES
    args       : Args
    statements : Statements

  METHODS
    method init( t, args, statements )

    method init( existing:WhichCase )
      prior.init( existing )
      if (existing.args) args = existing.args.cloned
      if (existing.statements) statements = existing.statements.cloned

    method description->String
      return "WhichCase($,$)" (%args,%statements)

endClass

class Print : Cmd
  PROPERTIES
    args : Args

  METHODS
    method init( t, args )

    method init( existing:Print )
      prior.init( existing )
      if (existing.args) args = existing.args.cloned

    method description->String
      return "Print($)" (%args)

endClass

class Println : Cmd
  PROPERTIES
    args : Args

  METHODS
    method init( t, args )

    method init( existing:Println )
      prior.init( existing )
      if (existing.args) args = existing.args.cloned

    method description->String
      return "Println($)" (%args)

endClass
